# Managed by infra repo â€” {{ instance_name }}
{% set stack = instance.network_stack | default(common.network_stack) %}
{% if stack == 'dual' %}
net.ipv6.conf.all.accept_ra=0
{% endif %}

net.core.default_qdisc=fq
net.ipv4.tcp_congestion_control=bbr

net.ipv4.ip_forward=1
{% if stack == 'dual' %}
net.ipv6.conf.all.forwarding=1
{% endif %}

net/ipv4/conf/default/rp_filter=1
net/ipv4/conf/all/rp_filter=1

net/ipv4/conf/default/accept_source_route=0
net/ipv4/conf/all/accept_source_route=0
{% if stack == 'dual' %}
net/ipv6/conf/default/accept_source_route=0
net/ipv6/conf/all/accept_source_route=0
{% endif %}

net/ipv4/conf/default/accept_redirects=0
net/ipv4/conf/all/accept_redirects=0
{% if stack == 'dual' %}
net/ipv6/conf/default/accept_redirects=0
net/ipv6/conf/all/accept_redirects=0
{% endif %}

net/ipv4/icmp_echo_ignore_broadcasts=1
net/ipv4/icmp_ignore_bogus_error_responses=1
net/ipv4/icmp_echo_ignore_all=0

net/ipv4/conf/default/log_martians=0
net/ipv4/conf/all/log_martians=0
